<!DOCTYPE>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>computer_graphic_HW4</title>
<style type="text/css">

      #info {
         position: absolute;
         top: 2%;
         width: 100%;
         padding: 10px;
         text-align: center;
         color: #ffff00
      }
      body {
         overflow: hidden;
      }

</style>
</head>
<body> 
  <div id="info"><br/>Planet_model</div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r74/three.min.js"></script>
  <script src="https://dl.dropboxusercontent.com/u/3587259/Code/Threejs/OrbitControls.js"></script>
  <script language="javascript" type="text/javascript">
    
     var scene, renderer, camera, controls; 
     var earth, earthFrame, clock = new THREE.Clock();

     init();
     animate();
     function loadPlanets() {
         earthFrame = new THREE.Object3D();
         var texture = THREE.ImageUtils.loadTexture('../images/sun.jpg');   
         var sun = new THREE.Mesh(new THREE.SphereGeometry(10, 32, 32), new THREE.MeshLambertMaterial({
                   map: texture, side: THREE.DoubleSide
         }));
         sun.position.set(0, 15, 0);
         scene.add(sun);
         var loader = new THREE.ObjectLoader();
         loader.load("../models/earth.json", function(object) {
                earth = object;
                earth.scale.set (10, 10, 10);
                earth.position.set(0, 12, 85);
                earthFrame.add(earth);
                scene.add( earthFrame );       
         });  
     }
     function init() {
         var width = window.innerWidth;
         var height = window.innerHeight;

         renderer = new THREE.WebGLRenderer({ antialias: true });
         renderer.setSize(width, height);
         renderer.setClearColor (0x000000);
         document.body.appendChild(renderer.domElement);

         scene = new THREE.Scene();
         camera = new THREE.PerspectiveCamera(45, width / height, 1, 10000);
         scene.add(camera);
         controls = new THREE.OrbitControls(camera, renderer.domElement);

         var gridXZ = new THREE.GridHelper(100, 10);
         gridXZ.setColors(new THREE.Color(0xff0000), new THREE.Color(0xffffff));
         scene.add(gridXZ);
         //light at the scene
         var pointLight = new THREE.PointLight(0xffffff, 25);
         pointLight.position.set(0, 15, 0);
         scene.add(pointLight);
         var ambientLight = new THREE.AmbientLight (0xffffff);
         scene.add(ambientLight);
         
         loadPlanets();
      }
      function animate() {   
         controls.update();
         animate.EarthRevoAngle = ( animate.EarthRevoAngle === undefined ) ? 0 : animate.EarthRevoAngle;
         animate.EarthAngle =  ( animate.EarthAngle  === undefined ) ? 0 : animate.EarthAngle ;
         var dt = clock.getDelta();
         
         if( earth !== undefined ) {
             //earth rotation
             animate.EarthAngle += Math.PI / 9 * dt;
             earth.rotation.y = -animate.EarthAngle;
             //earth revoulution rotation
             animate.EarthRevoAngle += Math.PI / 30 * dt;
             earthFrame.rotation.y = animate.EarthRevoAngle;
             var cameraOffset = earthFrame.localToWorld(new THREE.Vector3(-70, 60, 150));
             camera.position.copy(cameraOffset);
             camera.lookAt(earthFrame.position);
         }
         requestAnimationFrame(animate);
         renderer.render(scene, camera);
      }

  </script>
</body>
</html>